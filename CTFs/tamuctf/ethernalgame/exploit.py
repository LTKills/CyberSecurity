# This exploit creates a length extension of the message '6'
import hashpumpy
import socket

if __name__ == '__main__':
    orig_data = '9'
    orig_digest = 'a44ce5dbed666647c2d571c91d41385beb16784030e849efae5af7c80f77da0b5f8a6c45d2ab467d781d4b6ffc83edf9b00bebe83d36d92349c0e64a3064ef93'
    append_data = '999999999999999999999999999999999999999999999999999'

    sock = socket.socket()
    sock.connect(('challenges.tamuctf.com', 8812))
    sock.recv(1024)
    for i in range(1, 1000):
        print i
        new_digest, new_data = hashpumpy.hashpump(orig_digest, orig_data, \
                                                  append_data, i)
        print('New data: ' + new_data)
        print('New hash: ' + new_digest)
        sock.send((str(2) + '\n').encode())
        sock.recv(1024) # receive options (doesn't matter)
        sock.send(new_data + '\n')
        sock.recv(1024) # receive options (doesn't matter)
        sock.send(new_digest + '\n')
        print sock.recv(1024).decode()

